import * as d3 from "d3";

export {drawForest};

function drawForest({
    svg,
    forest,

    width = 300,
    height = 300,
}) {
    // Adapt SVG size
    svg.style("width", width).style("height", height);

    // test data
    const corrtest = [[1, 0.84806144, 0.8423422, 0.84532505, 0.83489716, 0.84461367, 0.83220005, 0.85079432, 0.85538381, 0.83820504],
    [0.84806144, 1, 0.83401406, 0.87462646, 0.82555926, 0.85139298, 0.83271378, 0.84075332, 0.85989422, 0.83791596],
    [0.8423422, 0.83401406, 1, 0.83634496, 0.81949854, 0.82843804, 0.84629029, 0.84439051, 0.84396917, 0.82080227],
    [0.84532505, 0.87462646, 0.83634496, 1, 0.82723719, 0.85546637, 0.83044404, 0.8450678, 0.86500645, 0.83159226],
    [0.83489716, 0.82555926, 0.81949854, 0.82723719, 1, 0.83391285, 0.81889743, 0.82621354, 0.83203411, 0.82427222],
    [0.84461367, 0.85139298, 0.82843804, 0.85546637, 0.83391285, 1, 0.8196792, 0.84251767, 0.85533285, 0.8244921],
    [0.83220005, 0.83271378, 0.84629029, 0.83044404, 0.81889743, 0.8196792, 1, 0.82533687, 0.83175564, 0.81892353],
    [0.85079432, 0.84075332, 0.84439051, 0.8450678, 0.82621354, 0.84251767, 0.82533687, 1, 0.8544603, 0.83461708],
    [0.85538381, 0.85989422, 0.84396917, 0.86500645, 0.83203411, 0.85533285, 0.83175564, 0.8544603, 1, 0.83848423],
    [0.83820504, 0.83791596, 0.82080227, 0.83159226, 0.82427222, 0.8244921, 0.81892353, 0.83461708, 0.83848423, 1]];

    // inverse correlation matrix to get distance measure
    const distmat = 1/corrtest;

    // starting values
    var x1 = 0;
    var y2 = 0;
    var x2 = 0;
    //var y2 = distmat(1,2);

    const mockedForest = [
        {x: 21, y: 8, strength: 0.5},
        {x: 31, y: 42, strength: 0.5},
        {x: 13, y: 50, strength: 0.77},
        {x: 48, y: 54, strength: 0.5},
        {x: 46, y: 88, strength: 0.3},
        {x: 9, y: 32, strength: 0.45},
        {x: 75, y: 77, strength: 0.1},
        {x: 42, y: 36, strength: 1},
        {x: 53, y: 18, strength: 0.5},
        {x: 89, y: 49, strength: 0.28},
    ];

    // Draw trees
    svg.selectAll("circle")
        .data(mockedForest)
        .enter().append("circle")
        .attr("cy", d => d.y * 3)
        .attr("cx", d => d.x * 3)
        .attr("r", d => Math.sqrt(d.strength / Math.PI) * 10 + 5)
        .style("fill", d => treeColor(d));
}

function treeColor(tree) {
        return d3.scaleLinear()
            .domain([1, 0])
            .range(["green", "red"])
            (tree.strength);
}